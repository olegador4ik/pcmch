{% load static %}
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="{% static 'style.css' %}?v=1.1">
</head>
<script>const savedTheme = sessionStorage.getItem('theme');if(savedTheme){document.documentElement.setAttribute('data-theme', savedTheme);}</script>
<body>
<button onclick="tgth()">Switch theme</button>
<div class="main">
  <p class="mt" id="q"></p>
  <svg id="svg" class="pcm" xmlns="http://www.w3.org/2000/svg">
    <line x1="2%", y1="50%", x2="98%", y2="50%", class="txc", style="stroke-width:2px;"/>
    <line x1="50%", y1="2%", x2="50%", y2="98%", class="txc", style="stroke-width:2px;"/>
    <polygon points="-5,10 0,0 5,10", transform="translate(250,0)", class="txc"/>
    <polygon points="-5,10 0,0 5,10", transform="translate(500,250) rotate(90)", class="txc"/>
    <polygon points="-5,10 0,0 5,10", transform="translate(250,500) rotate(180)", class="txc"/>
    <polygon points="-5,10 0,0 5,10", transform="translate(0,250) rotate(270)", class="txc"/>
    <text x="260" y="20", class="txc">T</text>
    <text x="480" y="270", class="txc">R</text>
    <text x="230" y="490", class="txc">F</text>
    <text x="10" y="240", class="txc">L</text>
    <g id="i" transform="translate(250,250)">
      <rect x="-10", y="-2.5", width="20", height="5", class="txc"/>
      <rect x="-10", y="-2.5", width="20", height="5", class="txc", transform="rotate(90)"/>
    </g>
  </svg>
  <div class="bts">
    <button onclick="renderQ(1)" id="y">Yes</button>
    <button onclick="renderQ(0)" id="n">No</button>
    <button onclick="renderQ(2)" id="f">Next</button>
    <button onclick="renderQ(3)" id="p">Previous</button>
  </div>
  <svg class="pcm2">
    <rect x="0", y="0", rx="3", width="100%", height="10", class="txc"/>
    <line id='m', x1="7", y1="50%", x2="490", y2="50%", style="stroke: var(--mnbg-color);stroke-width:5px;"/>
  </svg>
</div>
<script src="{% static 'script.js' %}?v=1.1"></script>
<script>
  const l = JSON.parse('{{ qs_json|escapejs }}');
  const q = document.getElementById("q");
  const i = document.getElementById("i");
  const m = document.getElementById("m");
  let c = 0;
  let j = l[c];
  let r = [];
  p.hidden = true;
  q.textContent = j.q;
  let e = 0;
  let t = 0;
  function renderQ(a) {
    let b = 1;
    function icountQ(a) {
      e += countQ(j.n, a)[0];
      t += countQ(j.n, a)[1];
      r.push(countQ(j.n, a)[1], countQ(j.n, a)[0]);
    }
    switch(a) {
      case 0:
        icountQ(1)
        break;
      case 1:
        icountQ(-1)
        break;
      case 2:
        r.push(0, 0);
        break;
      case 3:
        e -= r[r.length - 1];
        t -= r[r.length - 2];
        r.splice(-2, 2);
        b = -1;
        break;
    };
    c += b;
    j = l[c];
    if (!j) {
      endQ(t, e)
    };
    if (c > 0) {
      p.hidden = false;
    } else {
      p.hidden = true;
    };
    console.log(t, e);
    console.log(r);
    u = (e*15.6)+250;
    y = (t*50)+250;
    q.textContent = j.q;
    m.setAttribute("x1", 2+(23*c));
    i.setAttribute("transform", "translate(" + y + "," + u + ")");
    }
</script>  
</body>
</html>